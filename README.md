# AutoGLM Web 控制台

> 🤖 让 AI 控制你的手机变得简单

这是一个基于 [Open-AutoGLM](https://github.com/zai-org/Open-AutoGLM) 的 Web 控制台，提供可视化界面来操作 AutoGLM 手机自动化功能。

## ✨ 特点

- 📦 **开箱即用**：双击启动，自动检测环境
- 🔍 **环境检测**：自动检测并引导配置所需环境
- 🎯 **分步引导**：一步一步完成配置，新手友好
- 🌐 **可视化界面**：告别命令行，浏览器操作
- 📱 **多种连接**：支持 USB 有线连接和 WiFi 无线连接
- 🔌 **多API支持**：智谱BigModel、ModelScope、自部署服务
- 💾 **配置保存**：API Key 自动保存，下次无需重新输入

---

## 🚀 快速开始

### 1. 安装 Python（如果还没有）

访问 [Python 官网](https://www.python.org/downloads/) 下载安装 Python 3.10+

> ⚠️ **重要**：安装时请勾选 `Add Python to PATH`

### 2. 启动控制台

双击 **`一键启动.bat`** 即可！

- 首次运行会自动安装依赖
- 浏览器会自动打开控制台页面
- 如果没有自动打开，手动访问 http://127.0.0.1:5000

| 启动方式 | 说明 |
|----------|------|
| 双击 `一键启动.bat` | ✅ 推荐，自动打开浏览器 |
| 命令行运行 `python server.py` | 手动启动，需先安装依赖 |

---

## 📋 使用流程

### 第一步：环境配置

打开页面后，左侧会自动检测环境：

| 检测项 | 说明 |
|--------|------|
| Python 环境 | 需要安装 Python 3.10+ |
| Open-AutoGLM | ✅ 已包含在项目中 |
| ADB 工具 | ✅ 已包含在项目中 |
| Python 依赖 | 首次运行自动安装 |
| 手机连接 | 需要连接手机（见下方说明） |
| ADB Keyboard | 需要安装到手机 |

---

### 第二步：连接手机

支持两种连接方式，**任选其一**即可：

#### 方式一：USB 有线连接（推荐新手使用）

> 📌 **适用场景**：日常使用，稳定可靠

**操作步骤：**

1. 用 **USB数据线** 连接手机和电脑
   > ⚠️ 请确保是数据线，不是只能充电的线
2. 手机上打开 **设置 → 关于手机**
3. 连续点击 **版本号** 7次，开启开发者模式
4. 进入 **设置 → 开发者选项**，开启 **USB 调试**
5. 手机弹出授权提示时，点击 **允许**（建议勾选"始终允许"）

#### 方式二：WiFi 无线连接

> 📌 **适用场景**：不想用数据线，手机和电脑在同一WiFi网络

**前置条件：**
- 手机系统 Android 11 或更高版本
- 手机和电脑连接同一个 WiFi 网络

**操作步骤：**

1. 进入手机 **设置 → 开发者选项**
2. 找到并开启 **无线调试**
3. 点击进入「无线调试」详情页
4. 首次连接需要 **配对**：
   - 点击「使用配对码配对设备」
   - 在电脑终端执行：`adb pair <IP地址>:<配对端口>`
   - 输入手机上显示的配对码
5. 记录页面显示的 **IP地址** 和 **端口**
6. 在控制台页面展开「WiFi 无线连接」面板
7. 输入 IP 和端口，点击 **连接**

> 💡 **提示**：端口号每次开启无线调试都可能变化，请以手机显示为准

---

### 第三步：安装 ADB Keyboard

手机连接成功后，需要安装 ADB Keyboard 输入法：

1. 确保手机已连接（USB 或 WiFi）
2. 页面上点击 **安装到手机** 按钮
3. 安装成功后，点击 **一键启用** 按钮
4. 如果一键启用失败，请在手机上手动启用：
   - **设置 → 系统 → 语言和输入法 → 虚拟键盘 → 管理键盘 → 开启 ADB Keyboard**

---

### 第四步：配置 API

控制台支持多种 API 服务：

| 服务商 | 说明 |
|--------|------|
| **智谱 BigModel** | ✅ 推荐，官方API，新用户有免费额度 |
| **ModelScope** | 开源社区托管服务 |
| **自定义** | 自己部署的服务，可不填 API Key |

#### 使用智谱 BigModel（推荐）

1. 访问 [智谱开放平台](https://open.bigmodel.cn/)
2. 注册/登录账号
3. 进入控制台 → **API Keys** → **创建密钥**
4. 复制 API Key，粘贴到页面的输入框
5. 点击 **验证并保存**

> 💡 新用户有免费额度，无需付费即可体验

#### 使用 ModelScope

1. 访问 [ModelScope](https://modelscope.cn/)
2. 注册/登录账号
3. 获取 API Token
4. 在控制台切换到「ModelScope」，填入 Token

#### 使用自部署服务

1. 在控制台切换到「自定义」
2. 填写你的服务地址（如 `http://192.168.1.100:8000/v1`）
3. API Key 可留空（取决于你的服务配置）
4. 点击 **验证并保存**

---

### 第五步：执行任务

1. 点击 **完成配置，开始使用** 进入任务执行界面
2. 在任务输入框输入指令，例如：
   - `打开微信`
   - `打开微信给张三发消息说你好`
   - `打开设置，调高屏幕亮度`
   - `打开淘宝搜索手机壳`
3. 点击 **开始执行**
4. 观察日志区域，查看执行过程

---

## 📁 项目结构

```
autoglm-web/
├── 一键启动.bat        # 双击启动（推荐）
├── server.py           # Web服务器
├── config.json         # 配置文件（自动生成）
├── requirements.txt    # Python依赖
├── README.md           # 本文件
├── static/
│   ├── index.html      # 页面
│   ├── style.css       # 样式
│   └── app.js          # 前端逻辑
├── Open-AutoGLM/       # 核心Agent功能（已包含）
├── platform-tools/     # ADB工具（已包含）
└── apk/
    └── ADBKeyboard.apk # 输入法APK（已包含）
```

---

## 🔧 技术说明

- **后端**：Python Flask
- **前端**：纯 HTML/CSS/JavaScript（无需构建）
- **依赖**：首次运行自动安装

---

## 🔒 安全提示

1. **API Key 保密**：不要分享给他人
2. **敏感操作**：转账、支付等操作需要手动确认
3. **监控执行**：运行时保持手机屏幕可见，便于观察执行情况

---

## 📄 许可证

本项目基于 Open-AutoGLM 开发，遵循相同的开源协议。

---

## ❓ 常见问题

### 手机未检测到

**可能原因及解决方法：**

1. **数据线问题**：确保使用的是数据线（非纯充电线），尝试换一根线
2. **USB接口问题**：尝试换一个 USB 接口，优先使用主板直连的接口
3. **未授权调试**：手机上会弹出「允许 USB 调试」提示，请点击允许
4. **驱动问题**：部分手机需要安装官方驱动（如小米助手、华为助手）

### ADB 版本冲突

如果检测时提示 `adb server version doesn't match`，说明系统中存在多个 ADB 版本。

**解决方法：**
1. 点击环境配置区域的 **检查ADB冲突** 按钮
2. 查看系统中所有 ADB 文件的路径
3. 将其他版本的 `adb.exe` 重命名为 `adb.exe.bak`

**常见冲突来源：**
- HBuilderX 自带的 ADB
- Android Studio SDK
- 手机助手软件（华为助手、小米助手等）

### ADB Keyboard 安装失败

1. 确保手机已解锁屏幕
2. 某些手机需要在开发者选项中开启 **USB安装** 或 **允许安装未知应用**
3. 尝试在开发者选项中关闭 **验证应用**
4. MIUI 用户需要登录小米账号并关闭 MIUI 优化

### ADB Keyboard 无法启用

部分手机系统限制了通过 ADB 启用输入法，需要手动操作：

1. 打开手机 **设置**
2. 进入 **系统 → 语言和输入法 → 虚拟键盘**（不同品牌路径可能不同）
3. 点击 **管理键盘**
4. 开启 **ADB Keyboard**

### WiFi 连接失败

1. **确认在同一网络**：手机和电脑必须连接同一个 WiFi
2. **端口变化**：每次开启无线调试，端口可能变化，请重新查看手机上显示的端口
3. **防火墙问题**：检查电脑防火墙是否阻止了连接
4. **首次需配对**：首次使用 WiFi 连接需要先用 `adb pair` 命令配对

### Python 不是内部命令

安装 Python 时没有勾选 `Add Python to PATH`。

**解决方法：**
- 方案1：重新运行 Python 安装程序，选择「Modify」，勾选「Add Python to PATH」
- 方案2：手动将 Python 安装目录添加到系统环境变量 PATH

### API 验证失败

1. **检查 Key**：确认 API Key 是否正确复制（注意首尾空格）
2. **网络问题**：检查网络连接，尝试访问 https://open.bigmodel.cn 是否正常
3. **额度问题**：确认账户有可用额度
4. **服务状态**：智谱官网可能在维护，稍后再试

### 任务执行无反应

1. 确保手机屏幕已解锁
2. 确保 ADB Keyboard 已启用
3. 查看日志区域的错误信息
4. 尝试点击「重新检测」确认设备连接正常
